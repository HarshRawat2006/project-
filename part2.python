import speech_recognition as sr
import webbrowser
import datetime
import os

# Initialize recognizer
recognizer = sr.Recognizer()

def listen_command():
    with sr.Microphone() as source:
        recognizer.adjust_for_ambient_noise(source, duration=1)
        print("Listening for a command...")
        audio = recognizer.listen(source)

    try:
        command = recognizer.recognize_google(audio, language="en-IN").lower()
        print("You said:", command)
        return command
    except sr.UnknownValueError:
        print("‚ùå Could not understand audio")
    except sr.RequestError:
        print("‚ùå Internet error")
    return ""

def execute_command(command):
    if "time" in command:
        now = datetime.datetime.now().strftime("%H:%M:%S")
        print("‚è∞ Current time is:", now)

    elif "open youtube" in command:
        webbrowser.open("https://youtube.com")
        print("üé¨ Opening YouTube...")

    elif "open google" in command:
        webbrowser.open("https://google.com")
        print("üåê Opening Google...")

    elif "play music" in command:
        # Adjust path to your music folder
        music_dir = "C:\\Users\\Public\\Music"
        songs = os.listdir(music_dir)
        if songs:
            os.startfile(os.path.join(music_dir, songs[0]))
            print("üéµ Playing music...")
        else:
            print("‚ö† No music found.")

    else:
        print("‚ùì Command not recognized")

while True:
    cmd = listen_command()
    if cmd:
        if "exit" in cmd or "quit" in cmd:
            print("üëã Exiting assistant.")
            break
        execute_command(cmd)
